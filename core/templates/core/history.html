{% extends "core/base.html" %}
{% block content %}

<style>
/* ---------- Container for centering the card ---------- */
.activity-container {
    display: flex;
    justify-content: center;
    padding: 40px 20px;
    background: #e0e5ec;
}

/* ---------- Activity Card ---------- */
.activity-card {
    background: #e0e5ec;
    padding: 30px 35px;
    width: 450px;
    border-radius: 20px;
    box-shadow:
        20px 20px 60px #bec3cf,
        -20px -20px 60px #ffffff;
}

h3 {
    text-align: center;
    margin-bottom: 20px;
}

/* ------- List Items ------- */
#activityList {
    padding: 0;
    margin: 0;
    list-style: none;
}

.activity-item {
    padding: 12px 15px;
    margin-bottom: 12px;
    background: #e0e5ec;
    border-radius: 12px;
    box-shadow:
        inset 5px 5px 12px #bec3cf,
        inset -5px -5px 12px #ffffff;
    transition: 0.2s;
}

.activity-item:hover {
    transform: scale(1.01);
}

.activity-item a {
    color: #0066cc;
    text-decoration: none;
    font-weight: bold;
}

.activity-item small {
    font-size: 12px;
    color: #444;
    display: block;
    margin-top: 5px;
}

/* ------- Neumorphic Button ------- */
#toggleBtn {
    width: 100%;
    padding: 12px;
    margin-top: 15px;
    border-radius: 12px;
    border: none;
    background: #e0e5ec;
    cursor: pointer;
    box-shadow:
        8px 8px 15px #bec3cf,
        -8px -8px 15px #ffffff;
    font-size: 16px;
    transition: 0.2s;
}

#toggleBtn:active {
    box-shadow:
        inset 8px 8px 15px #bec3cf,
        inset -8px -8px 15px #ffffff;
}
</style>

<div class="activity-container">
    <div class="activity-card">
        {% if messages %}
        <div class="messages mb-3">
            {% for message in messages %}
            <div class="alert 
                {% if message.tags %}alert-{{ message.tags }}{% else %}alert-info{% endif %}" 
                role="alert">
                {{ message }}
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <h3><strong>History</strong></h3> 

        <ul id="activityList">

            {% for a in activities|slice:":5" %}
            <li class="activity-item">
                <strong>{{ a.get_action_display }}</strong>
                {% if a.article %}
                ‚Äî <a href="{{ a.article.get_absolute_url }}">{{ a.article.title }}</a>
                {% endif %}
                <small>{{ a.timestamp|date:"Y-m-d H:i" }}</small>
            </li>
            {% endfor %}

            {% for a in activities|slice:"5:" %}
            <li class="activity-item extra" style="display:none;">
                <strong>{{ a.get_action_display }}</strong>
                {% if a.article %}
                ‚Äî <a href="{{ a.article.get_absolute_url }}">{{ a.article.title }}</a>
                {% endif %}
                <small>{{ a.timestamp|date:"Y-m-d H:i" }}</small>
            </li>
            {% endfor %}
        </ul>

        {% if activities|length > 5 %}
        <button id="toggleBtn">Show More</button>
        {% endif %}
        
        <button type="submit" name="clear_history" 
        style="
            border: none;
            background: #e0e5ec;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            box-shadow: 5px 5px 12px #bec3cf, -5px -5px 12px #ffffff;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.2s;
        "
        title="Clear History"
        onclick="return confirm('Are you sure you want to clear all history?');"
    >
        üóëÔ∏è
    </button>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {
    const btn = document.getElementById("toggleBtn");
    const extras = document.querySelectorAll(".extra");
    let open = false;

    btn?.addEventListener("click", () => {
        open = !open;

        extras.forEach(i => {
            i.style.display = open ? "block" : "none";
        });

        btn.textContent = open ? "Show Less" : "Show More";
    });
});
</script>

{% endblock %}
